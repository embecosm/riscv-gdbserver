2019-09-16  Maxim Blinov  <maxim.blinov@embecosm.com>

	* server/GdbServerImpl.cpp (GdbServerImpl::rspInsertMatchpoint)
	(GdbServerImpl::rspRemoveMatchpoint): Change erroneous
	literal 'one' numeral to literal 'l' character in format string.

2019-05-28  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* targets/ri5cy/Ri5cyImpl.cpp (Ri5cyImpl::stepInstr)
	(Ri5cyImpl::runToBreak): If we hit a breakpoint set the PC back to
	the address of the previous instruction, to match the behavior of
	upstream GDB.

2018-04-04  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/GdbServerImpl.cpp (GdbServerImpl::rspSyscallRequest):
	Don't store a continuation state for exit syscall.

2018-04-04  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/GdbServerImpl.cpp (GdbServerImpl::GdbServerImpl):
	Initialise mSyscallContinuation.
	(GdbServerImpl::rspServer): Reset mSyscallContinuation after each
	new connection.
	(GdbServerImpl::rspSyscallRequest): Take parameter, update
	mSyscallContinuation.
	(GdbServerImpl::rspSyscallReply): Hangle mSyscallContinuation,
	don't return a bool.
	(GdbServerImpl::rspContinue): Pass parameter to rspSyscallRequest.
	(GdbServerImpl::rspSingleStep): Call rspSyscallRequest to handle
	syscalls.
	(GdbServerImpl::rspClientRequest): Return after processing syscall
	reply.
	* server/GdbServerImpl.h (GdbServerImpl::lastPacketType): Delete.
	(GdbServerImpl::SyscallContinuationType): New enum type.
	(GdbServerImpl::mSyscallContinuation): New member variable.
	(GdbServerImpl::rspSyscallRequest): Update parameter list.
	(GdbServerImpl::rspSyscallReply): Update return type.

2018-04-01  Andrew Burgess  <andrew.burgess@embecosm.com>

	* targets/gdbsim/GdbSimImpl.cpp (GdbSimImpl::doOneStep): Use ECALL
	for syscalls, and correctly spot C.EBREAK or EBREAK for breakpoints.
	(GdbSimImpl::stoppedAtSyscall): Delete definition.
	* targets/gdbsim/GdbSimImpl.h (GdbSimImpl::stoppedAtSyscall):
	Delete declaration.

2018-04-01  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/GdbServerImpl.cpp (GdbServerImpl::rspReadReg): Return an
	error when accessing an invalid register.

2018-03-22  Andrew Burgess  <andrew.burgess@embecosm.com>

	* targets/gdbsim/GdbSimImpl.cpp (GdbSimImpl::doOneStep): Detect
	compressed break instructions as well as uncompressed.

2018-03-15  Andrew Burgess  <andrew.burgess@embecosm.com>

	* targets/gdbsim/GdbSimImpl.cpp (GdbSimImpl::GdbSimImpl):
	Initialise new member variables.  Call reset to do work.
	(GdbSimImpl::reset): Close previous simulator, and open a new
	simulator.
	(GdbSimImpl::readRegister): Update error message to put register
	number in hex.
	(GdbSimImpl::doOneStep): Better support for different reasons the
	simulator might stop.
	* targets/gdbsim/GdbSimImpl.h (GdbSimImpl::mHaveReset): Declare
	new member variable.

2017-12-21  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/SyscallReplyPacket.h: New file.
	* server/GdbServerImpl.cpp: Add cassert, and SyscallReplyPacket.h
	include.
	(GdbServerImpl::rspSyscallReply): Rewrite using
	SyscallReplyPacket.
	(GdbServerImpl::rspClientRequest): Use return value from
	rspSyscallReply.
	* server/GdbServerImpl.h (GdbServerImpl::rspSyscallReply): Change
	return type.
	* server/Makefile.am (ALL_SOURCES): Add SyscallReplyPacket.h.
	* server/Makefile.in: Regenerated.

2017-12-05  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/StreamConnection.cpp
	(StreamConnection::StreamConnection): Initialise mIsConnected.
	(StreamConnection::rspClose): Update header comment, set
	mIsConnected.
	(StreamConnection::isConnected): Return mIsConnected.
	(StreamConnection::getRspCharRaw): Return -1 when zero bytes are
	read, this should only happen when stdin is closed.
	* server/StreamConnection.h (StreamConnection::mIsConnected):
	Declare new member variable.

2017-11-20  Andrew Burgess  <andrew.burgess@embecosm.com>

	* configure.ac: Add check for -faligned-new, and add to CXXFLAGS.
	* m4/cxx_flags_check.m4: New file.
	* Makefile.in: Regenerate.
	* aclocal.m4: Regenerate.
	* configure: Regenerate.
	* server/Makefile.in: Regenerate.
	* targets/Makefile.in: Regenerate.
	* targets/common/Makefile.in: Regenerate.
	* targets/gdbsim/Makefile.in: Regenerate.
	* targets/pegasus/Makefile.in: Regenerate.
	* targets/ri5cy/Makefile.in: Regenerate.
	* trace/Makefile.in: Regenerate.

2018-02-26  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/GdbServerImpl.cpp (GdbServerImpl::rspClientRequest):
	Rephrase comment so GCC's fall-through warning doesn't trigger.

2018-02-26  Andrew Burgess  <andrew.burgess@embecosm.com>

	* Makefile.in: Regenerate.
	* aclocal.m4: Regenerate.
	* config.h.in: Regenerate.
	* configure: Regenerate.
	* configure.ac: Allow all the targets to be optional.  Add build
	flags to support this.
	* server/Makefile.am: Don't depend on any particular target being
	present.
	* server/Makefile.in: Regenerate.
	* server/main.cpp: Only pull in target headers if the target is
	configured for this build.
	(createCpu): Only support instantiating targets configured for
	this build.
	* targets/Makefile.am: Don't depend on any particular target being
	present.
	* targets/Makefile.in: Regenerate.
	* targets/common/Makefile.in: Regenerate.
	* targets/gdbsim/Makefile.in: Regenerate.
	* targets/picorv32/Makefile.in: Regenerate.
	* targets/ri5cy/Makefile.in: Regenerate.
	* trace/Makefile.in: Regenerate.

2017-10-22  Andrew Burgess  <andrew.burgess@embecosm.com>

	* configure.ac: Turn -Wextra on by default.
	* configure: Regenerate.

2017-10-22  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/Utils.cpp (Utils::hex2Char): Remove 'const' qualifier
	from return type.
	* server/Utils.h (Utils::hex2Char): Likewise.

2017-10-22  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/Utils.cpp (Utils::hex2RegVal): Use shift and bitwise or.
	(Utils::hex2Val): Likewise.

2017-10-22  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/GdbServerImpl.cpp (GdbServerImpl::interruptTimeout):
	Initialise.
	(GdbServerImpl::rspContinue): Remove interruptTimeout.
	* server/GdbServerImpl.h (GdbServerImpl::interruptTimeout):
	Declare.

2017-10-22  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/GdbServerImpl.cpp (GdbServerImpl::GdbServerImpl): Update
	member variable name.
	(GdbServerImpl::rspContinue): Likewise.
	(GdbServerImpl::rspCommand): Likewise.
	* server/GdbServerImpl.h (GdbServerImpl::timeout): Renamed to...
	(GdbServerImpl::mTimeout): ...this.

2017-10-22  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/GdbServerImpl.cpp (GdbServerImpl::rspContinue): New definition.
	(GdbServerImpl::rspSingleStep): New definition.
	(GdbServerImpl::rspClientRequest): Move continue and step logic
	into separate functions.
	* server/GdbServerImpl.h (GdbServerImpl::rspContinue): New declaration.
	(GdbServerImpl::rspSingleStep): New declaration.

2017-09-21  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/GdbServerImpl.cpp (GdbServerImpl::rspSyscallRequest): Fix
	up usage of new PRIxREG.
	* targets/common/RegisterSizes.h (PRIuREG): Changed to...
	(PRIxREG): ...this.

2017-10-20  Andrew Burgess  <andrew.burgess@embecosm.com>

	* configure.ac: Make -with-wall the default, turning on -Wall.
	* configure: Regenerate.

2017-10-20  Andrew Burgess  <andrew.burgess@embecosm.com>

	* targets/common/RegisterSizes.h (PRIuREG): Define base on whether
	we're doing 32 or 64 bit build.
	* server/GdbServerImpl.cpp (GdbServerImpl::rspSyscallRequest):
	Make use of PRIuREG format specifier.

2017-10-20  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/GdbServerImpl.cpp (GdbServerImpl::rspSyscallReply): Don't
	compare unsigned variable with signed immediate.

2017-10-20  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/RspPacket.cpp (RspPacket::packStr): Change type of some
	locals.
	(RspPacket::packHexstr): Likewise.
	(RspPacket::packRcmdStr): Likewise.
	* server/RspPacket.h (bufSize): Change type.
	(len): Likewise.
	* server/GdbServerImpl.cpp (GdbServerImpl::rspWriteAllRegs):
	Change type of some locals.
	(GdbServerImpl::rspWriteReg): Likewise.
	(GdbServerImpl::rspWriteMemBin): Likewise, also update sscanf
	format to match.
	(GdbServerImpl::rspWriteMemBin): Change type of some locals.
	(GdbServerImpl::rspRemoveMatchpoint): Likewise.
	(GdbServerImpl::rspInsertMatchpoint): Likewise.

2017-10-20  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/main.cpp (main): Remove 'flags' and 'silent', unused
	variables.
	* server/GdbServerImpl.cpp (GdbServerImpl::rspClientRequest):
	Remove 'timeout_start', unused variable.

2017-10-20  Andrew Burgess  <andrew.burgess@embecosm.com>

	* configure.ac: Add new options to enable or disable Wall, Wextra,
	and Werror compiler flags.
	* configure: Regenerate.

2017-10-19  Andrew Burgess  <andrew.burgess@embecosm.com>

	* configure.ac: Provide a default value for the top module name of
	the ri5cy model.
	* configure: Regenerate.

2017-09-26  Andrew Burgess  <andrew.burgess@embecosm.com>

	* Makefile.in: Regenerate.
	* configure:  Regenerate.
	* configure.ac: Add support for new --with-gdbsim-modeldir
	configure option.  Add gdbsim target makefile to list of makefiles
	to generate.
	* server/Makefile.am: Add suport for linking gdbsim in.
	* server/Makefile.in: Regenerate.
	* server/main.cpp: Support for creating gdbsim targets.
	* targets/Makefile.am: Add support for building gdbsim target.
	* targets/Makefile.in: Regenerate.
	* targets/common/Makefile.in: Regenerate.
	* targets/gdbsim/GdbSim.cpp: New file.
	* targets/gdbsim/GdbSim.h:New file.
	* targets/gdbsim/GdbSimImpl.cpp: New file.
	* targets/gdbsim/GdbSimImpl.h: New file.
	* targets/gdbsim/Makefile.am: New file.
	* targets/gdbsim/Makefile.in: New file.
	* targets/ri5cy/Makefile.in: Regenerate.
	* trace/Makefile.in: Regenerate.

2017-09-21  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/GdbServerImpl.cpp (GdbServerImpl::rspClientRequest):
	Handle new ITarget::ResumeRes::STEPPED.
	* targets/ITarget.cpp (operator<<): Handle printing for new
	ITarget::ResumeRes::STEPPED.
	* targets/ITarget.h (ITarget::ResumeRes): Add STEPPED.
	* targets/ri5cy/Ri5cyImpl.cpp (Ri5cyImpl::stepInstr): Return
	ITarget::ResumeRes::STEPPED when appropriate.

2017-09-22  Andrew Burgess  <andrew.burgess@embecosm.com>

	* targets/ri5cy/Ri5cy.h: Fix comment.

2017-09-22  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/main.cpp (main): Use new local variable instead of global
	optind where possible.

2017-09-21  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/main.cpp (usage): Mention 'version' new options, move
	gdbserver_name into file scope.
	(gdbserver_name): New file scope variable.
	(show_version): New function.
	(main): Check for and handle new 'version' options.

2017-09-21  Andrew Burgess  <andrew.burgess@embecosm.com>

	* targets/ri5cy/Ri5cyImpl.h (Ri5cyImpl::stoppedAtSyscall): Declare
	new member function.
	* targets/ri5cy/Ri5cyImpl.cpp (Ri5cyImpl::stoppedAtSyscall):
	Define new member function.
	(Ri5cyImpl::stepInstr): Use new member function.
	(Ri5cyImpl::runToBreak): Likewise.

2017-09-21  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/GdbServerImpl.cpp (GdbServerImpl::rspClientRequest): No
	longer pass SyscallInfo parameter.
	* targets/ITarget.cpp: Update header comment.
	* targets/ITarget.h (ITarget::resume): Remove SyscallInfo
	parameter from both versions of this method.
	* targets/common/Makefile.am: Remove references to deleted files.
	* targets/common/Makefile.in: Regenerate.
	* targets/common/SyscallInfo.cpp: Deleted.
	* targets/common/SyscallInfo.h: Deleted.
	* targets/ri5cy/Ri5cy.cpp (Ri5cy::resume): Remove SyscallInfo
	parameter from both versions of this function.
	* targets/ri5cy/Ri5cy.h (Ri5cy::resume): Remove SyscallInfo
	parameter from both versions of this function.
	* targets/ri5cy/Ri5cyImpl.cpp (Ri5cyImpl::resume): Remove
	SyscallInfo parameter from both versions of this function.
	(Ri5cyImpl::stepInstr): Likewise.
	(Ri5cyImpl::runToBreak): Likewise.
	* targets/ri5cy/Ri5cyImpl.h (Ri5cyImpl::resume): Remove
	SyscallInfo parameter from both versions of this function.
	(Ri5cyImpl::stepInstr): Likewise.
	(Ri5cyImpl::runToBreak): Likewise.
	* targets/picorv32/Picorv32.cpp (Picorv32::resume): Remove
	SyscallInfo parameter.
	* targets/picorv32/Picorv32.h (Picorv32::resume): Remove
	SyscallInfo parameter.

2017-09-21  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/main.cpp (createCpu): New function.
	(main): Move creation of cpu object into new function.

2017-09-21  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/main.cpp (cpu): Renamed to...
	(globalCpu): ...this, and initialise to nullptr.
	(main): Update references to 'cpu' to 'globalCpu'.
	(sc_time_stamp): Likewise.

2017-09-21  Andrew Burgess  <andrew.burgess@embecosm.com>

	* targets/ITarget.h (ITarget::ITarget): Make TraceFlags const.
	* targets/ri5cy/Ri5cy.cpp (Ri5cy::Ri5cy): Likewise.
	* targets/ri5cy/Ri5cy.h (Ri5cy::Ri5cy): Likewise.
	* targets/ri5cy/Ri5cyImpl.cpp (Ri5cyImpl::Ri5cyImpl): Likewise.
	* targets/ri5cy/Ri5cyImpl.h (Ri5cyImpl::Ri5cyImpl): Likewise.

2017-09-13  Andrew Burgess  <andrew.burgess@embecosm.com>

	* config.h.in: Regenerate.
	* configure: Regenerate.
	* configure.ac: Add --with-xlen configure switch.
	* server/Disassembler.cpp: Add config.h include.
	(Disassembler::Disassembler): Set correct mach depending on if
	we're building 32 or 64 bit.
	* server/main.cpp: Add config.h include.
	(usage): Select correct program name based on whether we're
	building 32 or 64 bit.
	* server/GdbServerImpl.cpp (GdbServerImpl::rspSyscallRequest):
	Change to use register type.
	(GdbServerImpl::rspReadAllRegs): Likewise.
	(GdbServerImpl::rspWriteAllRegs): Likewise.
	(GdbServerImpl::rspReadReg): Likewise.
	(GdbServerImpl::rspWriteReg): Likewise.
	* server/GdbServerImpl.h: Add RegisterSizes.h include.
	(GdbServerImpl::RISCV_NUM_REG_BYTES): Depend on register size.
	* server/Makefile.am: Make program name switchable at configure
	time.
	* server/Makefile.in: Regenerate.
	* targets/ITarget.h: Add RegisterSizes.h include.
	(ITarget::readRegister): Update parameter types to use register
	size types.
	(ITarget::writeRegister): Likewise.
	* targets/common/RegisterSizes.h: New file.
	* targets/ri5cy/Ri5cy.cpp (Ri5cy::readRegister): Update parameter
	types to use register size types.
	(Ri5cy::::writeRegister): Likewise.
	* targets/ri5cy/Ri5cy.h (Ri5cy::readRegister): Update parameter
	types to use register size types.
	(Ri5cy::::writeRegister): Likewise.
	* targets/ri5cy/Ri5cyImpl.cpp (Ri5cyImpl::readRegister): Update to
	use register size types.
	(Ri5cyImpl::writeRegister): Likewise.
	(Ri5cyImpl::readDebugReg): Likewise.
	(Ri5cyImpl::writeDebugReg): Likewise.
	(Ri5cyImpl::runToBreak): Likewise.
	* targets/ri5cy/Ri5cyImpl.h (Ri5cyImpl::readRegister): Update
	parameters to use register size types.
	(Ri5cyImpl::writeRegister): Likewise.
	(Ri5cyImpl::readDebugReg): Likewise.
	(Ri5cyImpl::writeDebugReg): Likewise.
	(Ri5cyImpl::DBG_PPC): Define using register size.

2017-09-12  Andrew Burgess  <andrew.burgess@embecosm.com>

	* Makefile.in: Regenerate with official automake 1.15 rather than
	a patched version.

2017-09-01  Andrew Burgess  <andrew.burgess@embecosm.com>

	* targets/ri5cy/Ri5cyImpl.h (Ri5cyImpl::DBG_PPC): Adjust for
	64-bit register width.

2017-08-29  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* server/Makefile.am: Rename final target to riscv64-gdbserver.
	* server/Makefile.in: Regenerated.
	* server/main.cpp: Use riscv64-gdbserver in usage message.

2017-08-29  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/GdbServerImpl.cpp (GdbServerImpl::rspSyscallRequest):
	Support for exit syscall.

2017-08-29  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* server/Makefile.am: Rename final target to riscv32-gdbserver.
	* server/Makefile.in: Regenerated.
	* server/main.cpp: Use riscv32-gdbserver in usage message.

2018-01-26  Andrew Burgess  <andrew.burgess@embecosm.com>

	* Makefile.in: Regenerate.
	* configure: Regenerate.
	* configure.ac: Remove '--with-binutils-libdir'.
	* server/Disassembler.cpp: Delete.
	* server/Disassembler.h: Delete.
	* server/GdbServerImpl.cpp (GdbServerImpl::GdbServerImpl): Remove
	use of mDisassembler.
	(GdbServerImpl::~GdbServerImpl): Likewise.
	(GdbServerImpl::command): Remove 'disas' command.
	* server/GdbServerImpl.h: Don't include disassembler header file.
	(GdbServerImpl::mDisassembler): Delete.
	* server/Makefile.am (riscv_gdbserver_SOURCES): Remove
	disassembler source files.
	(riscv_gdbserver_LDADD): Remove libopcodes, and libbfd from the
	link.
	* server/Makefile.in: Regenerate.
	* server/main.cpp (usage): Remove reference to disas trace flag.
	* targets/ri5cy/Ri5cyImpl.cpp (Ri5cyImpl::clockModel): Remove
	disassembler trace.
	* targets/Makefile.in: Regenerated.
	* targets/common/Makefile.in: Regenerated.
	* targets/picorv32/Makefile.in: Regenerated.
	* targets/ri5cy/Makefile.in: Regenerated.
	* trace/TraceFlags.cpp (TraceFlags::TraceFlags): Remove disas flag.
	(TraceFlags::traceDisas): Delete.
	* trace/TraceFlags.h (TraceFlags::traceDisas): Delete declaration.
	* trace/Makefile.in: Regenerated.

2017-08-28  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* README.md: Bring build instructions up to date for latest code
	developments.

2017-08-28  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* README.md: Do not suggested SSH connection for model by default.

2017-08-15  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/GdbServerImpl.cpp (GdbServerImpl::GdbServerImpl):
	Initialise rsp member using initialisation list, not within
	method body.
	(GdbServerImpl::~GdbServerImpl): Don't delete rsp member.

2017-08-10  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	Break out trace as a library in its own right to be shared by
	targets and GdbServer. Make targets aware of their associated
	server and provide an interface for them to access server
	functionality. Use this to move disassembly to be generic.

	* Makefile.am: Break out trace into its own library.
	* Makefile.in: Regenerated.
	* configure: Regenerated.
	* configure.ac: Create Makefile for trace.
	* server/AbstractConnection.h: Use standards compliant header
	guard.
	* server/Disassembler.cpp: Moved from targets/ri5cy.
	(Disassembler::Disassembler): Use sprintf as the output function
	and replace C-style casts.
	(Disassembler::~Disassembler): Moved here from header.
	(Disassembler::disassemble): Remove C style casts
	* server/Disassembler.h: Moved from targets/ri5cy, use standards
	compliant header guard.
	(class Disassembler): Move to consistent camel case variable
	naming and allow disassemble to return via a stream.
	* server/GdbServer.cpp: Created after moving old version to
	GdbServerImpl.cpp.
	* server/GdbServer.h Created after moving old version to
	GdbServerImpl.h.
	* server/GdbServerImpl.cpp: Moved from GdbServer.cpp, class
	renamed throughout and constants moved into class in header file.
	(GdbServerImpl::GdbServerImpl): Create disassembler
	(GdbServerImpl::~GdbServerImpl): Delete disassembler
	(GdbServerImpl::command): Created.
	* server/GdbServerImpl.h: Moved from GdbServer.h and class renamed
	throughout.
	(class GdbServerImpl): Constants moved into class, new member
	function, command, added.
	* server/Makefile.am: Add Disassembler.h and Disassember.cpp and
	add binutils include directory to CPPFLAGS.
	* server/Makefile.in: Regenerated.
	* server/MpHash.h: Use standards compliant header guard.
	* server/RspConnection.h: Likewise.
	* server/RspPacket.h: Likewise.
	* server/StreamConnection.h: Likewise.
	* server/TraceFlags.cpp: Moved to trace directory.
	* server/TraceFlags.h: Moved to trace directory.
	* server/main.cpp (main): Use new ITarget interface for
	constructor, passing in flag structure, rather than just the VCD
	flag, pass gdbServer to target after instantiation.
	* targets/ITarget.h (class ITarget): Add gdbServer method.
	* targets/Makefile.am: Add server and trace include directories.
	* targets/Makefile.in: Regenerated.
	* targets/common/SyscallInfo.h: Use standards compliant header
	guard.
	* targets/picorv32/Makefile.am: Add server and trace include
	directories and break out CPPFLAGS from CXXFLAGS
	* targets/picorv32/Makefile.in: Regenerated.
	* targets/picorv32/Picorv32.cpp (Picorv32::Picorv32): Take all
	flags as argument.
	(Picorv32::reset): Pass flags to new instantiation.
	(Picorv32::gdbServer): Created.
	* targets/picorv32/Picorv32.h: Use standards compliant header
	guard.
	(class Picorv32): Change prototype of constructor, add gdbserver
	method, remove mWantVcd and replace with mFlags.
	* targets/picorv32/Picorv32Impl.cpp: Take flags as argument to
	constructor and use to initialize mWantVcd.
	* targets/picorv32/Picorv32Impl.h: Use standards compliant header
	guard, add GdbServer.h and TraceFlags.h headers.
	(class Picorv32Impl): Change prototype of constructor.
	* targets/ri5cy/Disassembler.cpp: Moved to server directory.
	* targets/ri5cy/Disassembler.h: Likewise.
	* targets/ri5cy/Makefile.am: Remove Disassembler.cpp and
	Disassemler.h, break out CPPFLAGS from CXXFLAGS and remove
	binutils include directory.
	* targets/ri5cy/Makefile.in: Regenerated.
	* targets/ri5cy/Ri5cy.cpp: Include GdbServer.h and TraceFlags.h
	(Ri5cy::Ri5cy): Use new prototype of constructor and for calling
	Ri5cyImpl constructor.
	(Ri5cy::gdbServer): Created.
	* targets/ri5cy/Ri5cy.h: Use standards compliant header guard.
	(class Ri5cy): Change prototype of constructor, add gdbServer
	method.
	* targets/ri5cy/Ri5cyImpl.cpp: Remove include of Disassembler.h
	and add GdbServer.h and TraceFlags.h, include sstream and add
	using for std:cout and std::ostringstream.
	(Ri5cyImpl::Ri5cyImpl): Change prototype, initialize mFlags and
	mServer members, remove initialization of mWantVcd, do not
	initialize disasembler.
	(Ri5cyImpl::~Ri5cyImpl): Do not delete diassembler.
	(Ri5cyImpl::gdbServer): Created.
	(Ri5cyImpl::clockModel): Use mFlags->traceVcd () instead of
	mWantVcd, call out to mServer to do diassembly.
	* targets/ri5cy/Ri5cyImpl.h: Use standards compliant header guard.
	(class Ri5cyImpl): Change prototype of constructor, add gdbsrever
	method, add members mFlags and mServer and remove mWantVcd.
	* trace/Makefile.am: Created.
	* trace/Makefile.in: Generated.
	* trace/TraceFlags.cpp: Moved from server directory.
	* trace/TraceFlags.h: Moved from server directory and use
	standards compliant header guard.

-2017-08-10  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	Use symbolic names for trace flags.

	* server/GdbServer.cpp (GdbServer::rspSetCommand): Remove
	"remote-debug", make "debug" take 2 args, flag name and value.
	(GdbServer::rspShowCommand): Remove "remote-debug2, allow "debug"
	to take a second arg to specify particular flags.
	* server/Makefile.am: Remove trailing whitespace.
	* server/Makefile.in: Regenerated.
	* server/TraceFlags.cpp (TraceFlags::iterator::iterator)
	(TraceFlags::iterator::operator++ TraceFlags::iterator::operator==)
	(TraceFlags::iterator::operator!= TraceFlags::iterator::operator*):
	Created.
	(TraceFlags::TraceFlags): Remove argument, initialize flags to zero.
	(TraceFlags::traceRsp TraceFlags::traceConn TraceFlags::traceBreak)
	(TraceFlags::traceVcd TraceFlags::traceSilent): Rename flags to
	mFlags.
	(TraceFlags::traceDisas TraceFlags::isFlag TraceFlags::flag)
	(TraceFlags::begin TraceFlags::end TraceFlags::flagLookup): Created.
	* server/TraceFlags.h (class TraceFlags): Add iterator nested
	class, remove setSilent, allFlags, add traceDisas, isFlag, flag,
	add flagInfo struct, rename flags as mFlags, add flagLookup helper.
	* server/main.cpp (usage): Add new trace info.
	(main): Use new flag argument handling.

2017-08-09  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/GdbServer.cpp (GdbServer::GdbServer): Add new parameter,
	initialise member variable.
	(GdbServer::rspClientRequest): Modify handling of kill packet.
	* server/GdbServer.h (GdbServer::KillBehaviour): New enum.
	(GdbServer::GdbServer): Add new parameter.
	(GdbServer::killBehaviour): New member variable.
	* server/main.cpp (main): Pass suitable GdbServer::KillBehaviour
	value to new GdbServer object.

2017-08-09  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/main.cpp (main): Delete connection.

2017-08-07  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	Fix the automake files for using disassembly.  The issue was that
	binutils dis-asm.h did not have print_insn_riscv marked as for
	external use.  Once that is resolved these changes allow the
	server to build.

	* Makefile.in: Regenerated.
	* configure: Regenerated.
	* configure.ac: Cleanly define BINUTILS_INCDIR and BINUTILS_LIBDIR
	* server/Makefile.am: No need for libibert in LDADD
	* server/Makefile.in: Regenerated.
	* targets/Makefile.in: Regenerated.
	* targets/common/Makefile.in: Regenerated.
	* targets/ri5cy/Disassembler.cpp: Add license header, use C++
	style C includes.
	* targets/ri5cy/Disassembler.h (class Disassembler): Add license
	header, use C++ style C includes
	* targets/ri5cy/Makefile.am: Simplify includes dir for binutils
	utils.
	* targets/ri5cy/Makefile.in: Regenerated.

2017-08-07  Ian Bolton  <ian.bolton@embecosm.com>

	* configure.ac: Some new configure parameters.
	* server/Makefile.am: Bring in required binutils libraries.
	* targets/ri5cy/Disassembler.cpp: New file.
	* targets/ri5cy/Disassembler.h: New file.
	* targets/ri5cy/Makefile.am: Compile new files.
	* targets/ri5cy/Ri5cyImpl.cpp: Call into Disassembler.
	* targets/ri5cy/Ri5cyImpl.h: New Disassembler member.

2017-08-04  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/AbstractConnection.cpp: New file.
	* server/AbstractConnection.h: New file.
	* server/GdbServer.cpp (GdbServer::GdbServer): Takes connection
	object instead of port number.
	* server/GdbServer.h (GdbServer::GdbServer): Takes connection
	object instead of port number.
	(GdbServer::rsp): Is now an AbstractConnection.
	* server/Makefile.am (riscv_gdbserver_SOURCES): Add new files.
	* server/Makefile.in: Regenerate.
	* server/RspConnection.cpp (RspConnection::RspConnection): Update
	initialisation list.
	(RspConnection::getPkt): Move to AbstractConnection.cpp.
	(RspConnection::putPkt): Likewise.
	(RspConnection::putRspChar): Likewise.
	(RspConnection::getRspChar): Likewise.
	(RspConnection::haveBreak): Likewise.
	* server/RspConnection.h: Add include.
	(class RspConnection): Add parent class.
	(getPkt): Moved to AbstractConnection.h.
	(putPkt): Likewise.
	(haveBreak): Likewise.
	(BREAK_CHAR): Likewise.
	(traceFlags): Likewise.
	(mHavePendingBreak): Likewise.
	(mGetCharBuf): Likewise.
	(mNumGetBufChars): Likewise.
	(putRspChar): Likewise.
	(getRspChar): Likewise.
	(putRspCharRaw): Mark as virtual.
	(getRspCharRaw): Likewise.
	* server/StreamConnection.cpp: New file.
	* server/StreamConnection.h: New file.
	* server/main.cpp: New includes.
	(usage): Add new options.
	(main): Handle new --stdin/s option, create a connection object of
	the correct type, and pass this to gdbserver.

2017-08-04  Andrew Burgess  <andrew.burgess@embecosm.com>

	* server/main.cpp (main): Check for null coreName.

2017-07-12  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* server/GdbServer.cpp: Add stdexcept header.

2017-07-12  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* server/GdbServer.cpp (GdbServer::rspSetCommand): Make catch
	friendlier to old compilers.

2017-07-12  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	Prior to GCC 5.0 std::put_time is not supported.

	* server/GdbServer.cpp: Remove using for std::put_time.
	(GdbServer::rspCommand): Rewrite timestamp to not use put_time.

2017-07-10  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* server/RspConnection.cpp (RspConnection::RspConnection):
	Initialize mHavePendingBreak.
	* targets/ri5cy/Ri5cyImpl.cpp: Add using declaration for std::cerr
	and std::endl.

2017-07-06  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* targets/picorv32/Picorv32.cpp (Picorv32::getCycleCount)
	(Picorv32::getInstrCount): Call corresponding method in
	mPicorv32Impl.
	* targets/picorv32/Picorv32Impl.cpp (Picorv32Impl::Picorv32Impl):
	Initialize mInstr.
	(Picorv32Impl::getCycleCount, Picorv32Impl::getInstrCount):
	Created.
	* targets/picorv32/Picorv32Impl.h (class Picorv32Impl): Add
	getCycleCount and getInstrCount.

2017-07-06  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* server/GdbServer.cpp: Include ctime, provide using for
	std::localtime and std::put_time.
	(GdbServer::rspClientRequest): Remove redundant std::chrono.
	(GdbServer::rspCommand): Fix some alignment issues, add OK
	responses for several commands, implement timestamp.

2017-07-05  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* server/GdbServer.cpp (GdbServer::rspCommand): Add missing
	monitor commands.
	(GdbServer::rspSetCommand): Created.
	(GdbServer::rspShowCommand): Created.
	* server/GdbServer.h (class GdbServer): Add rspSetCommand and
	rspShowCommand methods.
	* server/RspPacket.cpp (RspPacket::packRcmdStr): Created.
	* server/RspPacket.h (class RspPacket): Add packRcmdStr method.
	* server/TraceFlags.cpp (TraceFlags::traceRsp): Add setter.
	(TraceFlags::allFlags): Created setter and getter.
	* server/TraceFlags.h: Add traceRsp setter and allFlags setter and
	getter methods.
	* server/Utils.cpp (Utils::split): Created.
	* server/Utils.h (class Utils): Added split method.

2017-07-04  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	This is a GDB server to work with RI5CY with 128-bit wide
	instruction FIFO. It also fixes a minor glitch with RSP.

	* server/RspConnection.cpp (RspConnection::RspConnection):
	Initialize mNumGetBufChars.
	* targets/ri5cy/Ri5cyImpl.cpp (Ri5cyImpl::stepInstr)
	(Ri5cyImpl::runToBreak): No need to flush the pipeline.

2017-07-04  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* server/GdbServer.cpp (GdbServer::rspCommand): Add "monitor
	cyclecount".
	* targets/ri5cy/Ri5cyImpl.h: Correct name of DBG_HIT_SSTH from
	DBG_HIT_SSTE.

2017-07-04  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* targets/ri5cy/Ri5cyImpl.cpp (Ri5cyImpl::stepInstr): Write
	DBG_CTRL after flushing pipeline.
	(Ri5cyImpl::runToBreak): Compute value for DBG_CTRL before
	flushing the pipeline, so can write DBG_CTRL in the next cycle.

2017-07-03  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* targets/ri5cy/Ri5cyImpl.cpp (Ri5cyImpl::runToBreak): Tried a
	different sequence.

2017-07-03  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	This implementation provides a way to resume continuously, but
	does not yet work with the RI5CY implementation. It seems the
	pipeline does not get fully flushed.

	* server/GdbServer.cpp (GdbServer::rspRemoveMatchpoint)
	(GdbServer::rspInsertMatchpoint): Just return empty packets, so
	GDB does breakpoints by steam.
	* targets/ri5cy/Ri5cyImpl.cpp (Ri5cyImpl::readRegister)
	(Ri5cyImpl::writeRegister): Warn rather than abort if asked for
	unkown registers, this is a GDB problem.
	(Ri5cyImpl::stepInstr): Write NPC first to flush pipeline.
	(Ri5cyImpl::runToBreak): Implementation provided, but does not yet
	work.

2017-07-03  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* targets/picorv32/Picorv32Impl.cpp: Unify header inclusion.
	* targets/ri5cy/Ri5cyImpl.cpp: Remove std::chrono:: namespace
	qualifiers throughout, covered by using declarations.
	(Ri5cyImpl::resetModel): Set the DBG_IE reg to trap on breakpoint
	and illegal instruction.
	(Ri5cyImpl::haltModel): Rewrite using waitForHalt.
	(Ri5cyImpl::waitForHalt): Created.
	(Ri5cyImpl::stepInstr): Rewritten to write the NPC to flush the
	pipeline.
	* targets/ri5cy/Ri5cyImpl.h (class Ri5cyImple): Add constants for
	DBG_IE fields and waitForHalt method.

2017-07-08  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* targets/ri5cy/Ri5cyImpl.cpp (Ri5cyImpl::stepInstr): clear
	fetch_enable_i.

2017-06-30  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* targets/ri5cy/Ri5cyImpl.cpp (Ri5cyImpl::resume): Deal with all
	types of step.
	(Ri5cyImpl::readRegister, Ri5cyImpl::writeRegister): Rewrite to
	use debug register access methods.
	(Ri5cyImpl::read, Ri5cyImpl::write): Access dp_ram, not sp_ram.
	(Ri5cyImpl::clockModel): Created.
	(Ri5cyImpl::resetModel, Ri5cyImpl::haltModel): Rewritten to use
	debug register access methods.
	(Ri5cyImpl::readDebugReg, Ri5cyImpl::writeDebugReg): Created.
	(Ri5cyImpl::stepInstr): Written to use SSTE debug interface and
	handle timeouts.
	* targets/ri5cy/Ri5cyImpl.h (class Ri5cyImpl): Add new debug
	flags, clockModel, readDebugReg, writeDebugReg, add timeout to
	stepInstr.

2017-06-29  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* server/GdbServer.cpp (GdbServer::rspCommand): Modify the
	horrible hack for exit - still a horrible hack though.
	* server/main.cpp (main): Delete the cpu at the end.
	* targets/ri5cy/Ri5cyImpl.cpp: Fix the headers for the new model.
	(Ri5cyImpl::resume): Mark unused param. Needs to be written properly.
	(Ri5cyImpl::read, Ri5cyImpl::write): Use single ported RAM.
	(Ri5cyImpl::resetModel): Set fetch_enable to 0 on reset.
	(Ri5cyImpl::stepInstr, Ri5cyImpl::runToBreak): Created.
	* targets/ri5cy/Ri5cyImpl.h: Add stepInstr and runToBreak.

2017-06-27  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	This commit syncrhonizes with all the work on the ri5cy_wip branch
	as far as it makes sense.

	* server/main.cpp (main): Tidy up a comment
	* targets/ri5cy/Ri5cyImpl.cpp: Include iostream and more Verilator
	model headers.
	(Ri5cyImpl::resume): Remove unused attributes and add
	implementation.
	(Ri5cyImpl::readRegister): Turn do-while into while loop when
	looking for rvalid.
	(Ri5cyImpl::writeRegister): Add implementation.
	(Ri5cyImpl::read, Ri5cyImpl::write): Add task based
	implementation..

2017-06-27  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	Add VCD generation as an option.

	* server/GdbServer.cpp (GdbServer::rspCommand): Pass argument to
	reset.
	* server/Makefile.am: Add more target libraries.
	* server/Makefile.in: Regenerated.
	* server/TraceFlags.cpp (TraceFlags::traceVcd): Created.
	* server/TraceFlags.h: Add traceVcd method and constant.
	* server/main.cpp: Include Ri5cy.h, make cpu static global.
	(main): Allow RI5CY target.
	(sc_time_stamp): Created.
	* targets/ITarget.h (class ITarget): Add constructor to take
	boolean arg, correct void argument lists, add timeStamp.
	* targets/picorv32/Picorv32.cpp (Picorv32::Picorv32): Pass in
	argument to select VCD.
	(Picorv32::timeStamp): Created.
	* targets/picorv32/Picorv32.h (class Picorv32): Add constructor to take
	boolean arg, correct void argument lists, add timeStamp.
	* targets/picorv32/Picorv32Impl.cpp (Picorv32Impl::Picorv32Impl):
	Initialize VCD.
	(Picorv32Impl::~Picorv32Impl): Close VCD.
	(Picorv32Impl::clockStep, Picorv32Impl::writeProgramAddr):
	Generate VCD when stepping.
	(Picorv32Impl::timeStamp): Created.
	* targets/picorv32/Picorv32Impl.h (class Picorv32Impl): Pass flag
	to constructor, add timeStamp method, add VCD member variables.
	* targets/ri5cy/Makefile.am: Add C include dirs.
	* targets/ri5cy/Makefile.in: Regenerated.
	* targets/ri5cy/Ri5cy.cpp (Ri5cy::Ri5cy): Add constructor to take
	boolean arg, correct void argument lists, add timeStamp.
	(Ri5cy::timeStamp): Creatd.
	* targets/ri5cy/Ri5cy.h (class Ri5cy): Pass arg to constructor,
	add timeStamp.
	* targets/ri5cy/Ri5cyImpl.cpp Include verilcated_vcd_c.h
	(Ri5cyImpl::Ri5cyImpl): Take arg, initialize VCD.
	(Ri5cyImpl::~Ri5cyImpl): Close VCD
	(Ri5cyImpl::resume, Ri5cyImpl::terminate,Ri5cyImpl::reset):
	Correct types.
	(Ri5cyImpl::readRegister): Fix typo, generated VCD.
	(Ri5cyImpl::writeRegister, Ri5cyImpl::read, Ri5cyImpl::write):
	Mark regs unused, return result.
	(Ri5cyImpl::insertMatchpoint, Ri5cyImpl::removeMatchpoint)
	(Ri5cyImpl::command): Mark args unused.
	(Ri5cyImpl::timeStamp): Created.
	(Ri5cyImpl::resetModel, Ri5cyImpl::haltModel): Generate VCD.
	* targets/ri5cy/Ri5cyImpl.h (class Ri5cyImpl): Correct types
	throughout.

2017-06-27  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	Remove compile time debug flag GDBSERVER_DEBUG.

	* Makefile.in: Regenerate.
	* server/GdbServer.cpp (GdbServer::rspRemoveMatchpoint)
	(GdbServer::rspInsertMatchpoint): Report details of matchpoint
	under control of trace flags.
	* server/RspConnection.cpp (RspConnection::rspConnect)
	(RspConnection::rspClose): Likewise.
	* server/TraceFlags.cpp (TraceFlags::traceRsp): Make constant.
	(TraceFlags::traceConn, TraceFlags::traceBreak)
	(TraceFlags::traceSilent, TraceFlags::setSilent): Created.
	* server/TraceFlags.h (class TraceFlags): Make read accessors
	constant, add traceConn, traceBreak, traceSilent and setSilent.
	* server/main.cpp (usage): Add help and silent flags.
	(main): Extend command line flag for silent running.

2017-06-25  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	This will not currently compile, but shows how the interface via
	the debug unit should work.

	* targets/ITarget.h (class ITarget): Add ResetType scoped
	enumeration, allow different types of reset, do not pass
	matchpoint addresses by reference.
	* targets/picorv32/Makefile.am: Add headers to sources, so they
	are included in the distribution.
	* targets/picorv32/Makefile.in: Regenerated.
	* targets/picorv32/Picorv32.cpp (Picorv32::reset): Provide
	argument for reset type
	(Picorv32::insertMatchpoint, Picorv32::removeMatchpoint): Pass
	address by value, not reference.
	* targets/picorv32/Picorv32.h (class Picorv32): Add argument to
	reset and pass address by value to insertMatchpoint and
	removeMatchpoint.
	* targets/picorv32/Picorv32Impl.cpp: Clarify header comment.
	* targets/picorv32/Picorv32Impl.h: Likewise.
	* targets/ri5cy/Makefile.am: Update list of sources.
	* targets/ri5cy/Makefile.in: Regenerated.
	* targets/ri5cy/Ri5cy.cpp: Created.
	* targets/ri5cy/Ri5cy.h: Created.
	* targets/ri5cy/Ri5cyImpl.cpp: Created.
	* targets/ri5cy/Ri5cyImpl.h: Created.

2017-06-25  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* configure.ac: Make model directories absolute.
	* configure: Regenerated.

2017-06-25  Graham Markall  <graham.markall@embecosm.com>

	* targets/picorv32/Picorv32.cpp: (RUN_SAMPLE_PERIOD) Add.
        (resume) When step is CONTINUE, step for RUN_SAMPLE_PERIOD
        instructions; if timeout expired, return TIMEOUT.
        Otherwise, repeat. Default timeout if none supplied is
        zero, resulting in single-stepping.

2017-06-24  Graham Markall  <graham.markall@embecosm.com>

	Partially-working implementation of Picorv32

	Reading and writing memory and registers works, as does
	single-stepping instructions. Breakpoints are not presently
	working.

        * server/GdbServer.cpp: (RISCV_PC_REGNUM) Remove, as it seems a
	bit specific to Picorv32 (it handles the PC differently to the
	rest of the register file).
        * targets/picorv32/Picorv32.cpp: (RISCV_PC_REGNUM) Add.
        (resume) Implement, but only single-stepping - no mutiple steps
	with timeouts. (terminate) Add comment. (reset)
	Implement. (readRegister, writeRegister) Fix handling of PC, which
	is a special case.

2017-06-24  Graham Markall  <graham.markall@embecosm.com>

	* targets/picorv32/Picorv32.cpp: (readRegister, writeRegister)
	(read, write) Implement.

2017-06-24  Graham Markall  <graham.markall@embecosm.com>

	Although this builds, the Picorv32 implementation is not yet
	functioning because the functions of Picorv32 are not yet
	implemented. Mostly they will be able to call into the
	Picorv32Impl class, but some of the functions will need a little
	more work.

	class should be very similar to the original Cpu class
	implementation, and the Picorv32 class adapts it and implements
	the ITarget interface.

	Some of the choices made here are not completely future-proof;
	when we add a second core (RI5CY) we may have problems with
	linking.

        * Makefile.in: Regenerate.
        * server/Makefile.am: Link with Verilated Picorv32 libraries.
        * server/Makefile.in: Regenerate.
        * targets/picorv32/Makefile.am: Compile Picorv32.cpp and
	Picorv32Impl.cpp. Include target, target/common, and verilated
	Picorv32 folders. Don't warn on unused params.
        * targets/picorv32/Makefile.in: Regenerate.
        * targets/picorv32/Picorv32.cpp: Replace old Cpu implementation
	with stub implementations of all methods of the Picorv32 class.
        * targets/picorv32/Picorv32Impl.cpp: Include Picorv32Impl.h,
	rename Cpu class to Picorv32Impl.
        * targets/picorv32/Picorv32Impl.h: Rename Cpu class to
	Picorv32Impl.

2017-06-16  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	* server/RspConnection.cpp (RspConnection::getRspCharRaw): Correct
	class name.
	* server/main.cpp (usage): Created.
	(main): Extend argument handling.
	* targets/ITarget.h: Correct single use #define.
	* targets/common/SyscallInfo.h: Likewise.
	* targets/picorv32/Picorv32.h (class Picorv32): Make class members
	non-virtual.

2017-06-14  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	WIP in progress on target abstraction.

	* Makefile.in: Regenerated.
	* server/GdbServer.cpp (GdbServer::rspClientRequest): Rewrite
	handling of 's' and 'S' packets.
	(GdbServer::rspReportException): Use static_cast instead of C
	style cast.
	(GdbServer::rspReadAllRegs, GdbServer::rspWriteAllRegs): Do not
	treat program counter as special case and use ITarget methods to
	access registers.
	(GdbServer::rspReadMem): Rewrite to use ITarget read method.
	(GdbServer::rspWriteMem): Rewrite to use ITarget write method.
	(GdbServer::rspReadReg, GdbServer::rspWriteReg): Do not treat
	program counter as special case and use ITarget methods to access
	registers.
	(GdbServer::rspCommand): Use ITarget reset method for "monitor
	reset".
	(GdbServer::rspVpkt): Do not handle 'v' packets for now.
	(GdbServer::rspWriteMemBin): Rewrite to use ITarget write method.
	(GdbServer::rspRemoveMatchpoint, GdbServer::rspInsertMatchpoint):
	Use reinterpret_cast instead of C style cast and use ITarget
	methods to read/write memory.
	* server/GdbServer.h: Include <inttypes.h> with STDC_FORMAT_MACROS.
	* targets/ITarget.h (class ITarget): Pass first argument to read
	and write methods by value, not reference.
	* targets/picorv32/Picorv32.cpp: Created.
	* targets/picorv32/Picorv32.h: Created.
	* targets/picorv32/Picorv32Impl.cpp: Renamed from ri5cy/Ri5cy.cpp.
	* targets/picorv32/Picorv32Impl.h: Renamed from ri5cy/Ri5cy.h.
	* targets/ri5cy/Ri5cy.cpp: Renamed as picorv32/Picorv32Impl.cpp.
	* targets/ri5cy/Ri5cy.h: Renamed as picorv32/Picorv32Impl.h.

2017-06-09  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	WIP progress to integrated existing model into the GDB server
	target abstraction.

	* server/Cpu.cpp: Moved to targets/ri5cy/Ri5cy.cpp.
	* server/Cpu.h: Moved to targets/ri5cy/Ri5cy.h.
	* server/GdbServer.cpp: Use ITarget.h, not Cpu.h, add using
	statements from chrono components. Use timeout, not clock_timeout
	throughout and make signals of scoped enumeration type TargetSignal.
	(GdbServer::GdbServer): Change type of cpu to ITarget, and
	initialize timeout as a duration.
	(GdbServer::rspClientRequest): Replace code for 'c'.
	(operator<<): Created.
	* server/GdbServer.h: Relace ctime by chrono header
	(class GdbServer): Make cpu of class ITarget, make signals a
	scoped enumeration, make timeout a duration.
	* server/Makefile.am: Remove Cpu.c and Cpu.h from SOURCES, add
	libtargets as a library and all the target include directories.
	* server/Makefile.in: Regnerated.
	* server/RspConnection.cpp:
	(RspConnection::putRspChar, RspConnection::getRspChar): Rewrite to
	use raw versions of functions and test for break.
	(RspConnection::haveBreak, RspConnection::putRspCharRaw)
	(RspConnectionLinux::getRspCharRaw): Created.
	* server/RspConnection.h (class RspConnection): Add new methods
	and member variable sot support them.
	* server/main.cpp: Replace Cpu.h by all the target headers.
	* targets/ri5cy/Ri5cy.cpp: Moved to server/Cpu.cpp.
	* targets/ri5cy/Ri5cy.h: Moved to server/Cpu.h.

2017-06-08  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	Restructure configure.ac to add a set of target specific options
	to locate verilator models and headers. We now have
	--with-verilator-headers
	--with-picorv32-modeldir
	--with-picorv32-topmodule
	--with-ri5cy-modeldir
	--with-ri5cy-topmodule

	For each new model, we add a new set of options.

	* Makefile.in: Regenerated.
	* config.h.in: Regenerated.
	* configure: Regenerated.
	* configure.ac: Remove --enable-32-bit, add --with-verilator-headers
	--with-picorv32-modeldir, --with-picorv32-topmodule,
	--with-ri5cy-modeldir, --with-ri5cy-topmodule, test for Verilator
	headers.
	* server/Makefile.in: Regenerated.
	* targets/Makefile.in: Regenerated.
	* targets/common/Makefile.in: Regenerated.
	* targets/picorv32/Makefile.in: Regenerated.
	* targets/ri5cy/Makefile.in: Regenerated.

2017-06-07  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	Infrastructure for an abstracted target interface class, ITarget.
	All targets should implement the interface class ITarget, declared
	in the "targets" subdirectory.  Each target should be in its own
	subdirectory of the "targets" directory.  There is also a "common"
	subdirectory for code common to all targets.

	The result is the libtargets library, which can be linked into the
	server code, which can instantiate the target of choice.  The
	current framework has placeholders for the PicoRV32 and RI5CY
	verilator models.

	* Makefile.am: Add new subdirectories and have automake include
	the m4 directory.
	* Makefile.in: Regenerated.
	* aclocal.m4: Regenerated for libtool.
	* compile: Generated.
	* config.guess: Generated.
	* config.h.in: Regenerated.
	* config.sub: Generated.
	* configure: Regenerated.
	* configure.ac: Now use libtool and for now comment out the
	verilator directory.
	* ltmain.sh: Generated.
	* m4/libtool.m4: Generated.
	* m4/ltoptions.m4: Generated.
	* m4/ltsugar.m4: Generated.
	* m4/ltversion.m4: Generated.
	* m4/lt~obsolete.m4: Generated.
	* server/Makefile.in: Regenerated.
	* targets/ITarget.cpp: Created
	* targets/ITarget.h: Created
	* targets/Makefile.am: Created
	* targets/Makefile.in: Generated.
	* targets/common/Makefile.am: Created
	* targets/common/Makefile.in: Generated.
	* targets/common/SyscallInfo.cpp: Created
	* targets/common/SyscallInfo.h: Created
	* targets/picorv32/Makefile.am: Created
	* targets/picorv32/Makefile.in: Generated.
	* targets/ri5cy/Makefile.am: Created
	* targets/ri5cy/Makefile.in: Generated.

2017-06-07  Jeremy Bennett  <jeremy.bennett@embecosm.com>

	Add in the autotools generated files.  I know that there is a
	debate about whether to do this.  But we'll follow the GNU tool
	chain practice of doing so.  It means you can clone and build out
	of the box.

	* .gitignore: Created.
	* COPYING: Generated.
	* INSTALL: Generated.
	* Makefile.in: Generated.
	* aclocal.m4: Generated.
	* config.h.in: Generated.
	* configure: Generated.
	* depcomp: Generated.
	* install-sh: Generated.
	* missing: Generated.
	* server/Makefile.in: Generated.


2017-05-25  Ian Bolton  <ian.bolton@embecosm.com>

	* server/GdbServer.cpp: Handle monitor reset, and make vKill
	behave in the same way (delete cpu and construct another).

2017-05-21  Ian Bolton  <ian.bolton@embecosm.com>

	* server/GdbServer.cpp: Handle vKill packet, so that server
	is terminated when GDB session quits.
	* server/RspConnection.cpp: Don't output to stdout unless
	GDBSERVER_DEBUG is defined.

2017-05-20  Ian Bolton  <ian.bolton@embecosm.com>

	* README.md: Mention building outside source tree and also
	expand example GDB session to cover breakpoints.

2017-05-20  Ian Bolton  <ian.bolton@embecosm.com>

	* README.md: Update status to mention breakpoints working.
	* server/Cpu.cpp: Add clearTrapAndRestartInstruction to properly
	continue after a breakpoint has caused a trap.
	* server/Cpu.h: New clearTrapAndRestartInstruction function.
	* server/GdbServer.cpp: Make single instruction stepping call
	clearTrapAndRestartInstruction before doing the step.

2017-05-20  Ian Bolton  <ian.bolton@embecosm.com>

	* configure.ac: Define and use VTESTBENCH variable.
	* README.md: Updated build instructions.
	* server/Makefile.am: No longer hardcode object locations.

2017-05-16  Ian Bolton  <ian.bolton@embecosm.com>

	* server/GdbServer.cpp: Debug only shown when GDBSERVER_DEBUG defined.

2017-05-16  Ian Bolton  <ian.bolton@embecosm.com>

	* README.md: Updated the GDB example session section.
	* server/Cpu.cpp: Bring step function in line with what GDB expects, to
	execute a single instruction rather than just one clock step.
	* server/Cpu.h: Add clock_step function.

2017-05-16  Ian Bolton  <ian.bolton@embecosm.com>

	* README.md: Added example GDB session instructions.

2017-05-16  Ian Bolton  <ian.bolton@embecosm.com>

	* server/Cpu.cpp: Write PC for each step while in reset, so that it is set
	in the model once out of reset.
	* server/GdbServer.cpp: Print out when we are writing PC and then read the
	value back to confirm it was written.
	* server/main.cpp: Cycling during reset has been deferred until we attempt
	to write PC.

2017-05-15  Ian Bolton  <ian.bolton@embecosm.com>

	* server/Cpu.cpp: Detect inReset and trap situations and return bool from step.
	* server/Cpu.h: Add inReset and haveTrap, and return bool from step.
	* server/GdbServer.cpp: Handle 32-bit breakpoint instructions correctly.
	* server/GdbServer.h: Correct BREAK_INSTR to EBREAK instruction pattern.
	* server/MpHash.cpp: Correct instructions to be 32-bits.
	* server/MpHash.h: Likewise.
	* server/main.cpp: Cycle until CPU no longer in reset. Remove redundant command line arguments.

2017-05-15  Ian Bolton  <ian.bolton@embecosm.com>

	* server/Cpu.cpp: Fix spelling mistake in comment.
	* server/Cpu.h: Likewise.
	* server/GdbServer.cpp: Likewise.
	* server/GdbServer.h: Likewise.
	* server/main.cpp: Likewise.

2017-05-15  Ian Bolton  <ian.bolton@embecosm.com>

	* server/Cpu.cpp: Call into readReg, writeReg within CPU correctly.
	* server/GdbServer.cpp: Continue should step without reporting exception.

2017-05-15  Ian Bolton  <ian.bolton@embecosm.com>

	* server/GdbServer.cpp: Corrected RISCV_PC_REGNUM to be 32.

2017-05-15  Ian Bolton  <ian.bolton@embecosm.com>

	* README.md: Add -g flag to CXXFLAGS in example configure command.
	* server/GdbServer.cpp: Respond to vMustReplyEmpty.
	* server/main.cpp: Create the Cpu object.

2017-05-13  Ian Bolton  <ian.bolton@embecosm.com>

	* README.md: Added commands required to build.

2017-05-12  Ian Bolton  <ian.bolton@embecosm.com>

	* AUTHORS: Created.
	* configure.ac: Created.
	* Makefile.am: Created.
	* NEWS: Created.
	* README: Created as symbolic link to README.md.
	* README.md: Updated with a note about lack of doc directory.
	* server/Cpu.cpp: Created.
	* server/Cpu.h: Created.
	* server/GdbServer.cpp: Created.
	* server/GdbServer.h: Created.
	* server/main.cpp: Created.
	* server/Makefile.am: Created.
	* server/MpHash.cpp: Created.
	* server/MpHash.h: Created.
	* server/RspConnection.cpp: Created.
	* server/RspConnection.h: Created.
	* server/RspPacket.cpp: Created.
	* server/RspPacket.h: Created.
	* server/TraceFlags.cpp: Created.
	* server/TraceFlags.h: Created.
	* server/Utils.cpp: Created.
	* server/Utils.h: Created.

2017-05-12  Ian Bolton  <ian.bolton@embecosm.com>

	* ChangeLog: Created.
	* README.md: Created.
